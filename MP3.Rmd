---
title: "MP3"
author: "Sneha Verma, Pema Choden, Tenzin Paldon"
date: "November 6, 2017"
output: html_document
---
##                 How Repetitive is Hollywood?

Is Hollywood more repetitive than it's ever been?

How often are remakes, sequels made? 

Lately, there has been a lot of criticism against remakes and sequels in Hollywood *(USA Today, 2016)*. One of most famous director of blockbusters, Steven Spielberg shared his concerns about this trend to Hollywood Reporter in June: “There’s going to be an implosion where three or four or maybe even a half-dozen megabudget movies are going to go crashing into the ground, and that’s going to change the paradigm.”

We want to study if the trend of sequels and remakes are a modern thing, or if it has existed since the beginning of film industry.

After some research on this topic, we realized that making sequels is no new phenomenon. The phenomenon of making sequels can be seen in one of the earliest forms of entertainment, oral storytelling. Homer’s Odyssey is in part a sequel to Iliad because of the widespread success of Iliad.  After oral poetry and storytelling, books are the oldest and most popular medium of entertainment. Some of the best sellers in late Victorian Era such as Robinson Crusoe (1719) and Gulliver’s Travels (1726) brought huge revenue to the publishers(Den of Geek). As a result of the huge economic gain, the publishers produced sequels like Memoirs of the Court of Lilliput (1727) and The New Gulliver (1730). This trend still exists in present day in TV Shows, books, and movies. We are all aware of the Fast and Furious Franchise, Hunger Games, Big Bang Theory, etc.

##Why make sequels?

 The first film, book, or show is the riskiest and most expensive. The makers have to invest a huge amount of money in advertising, building the story plot, costumes, etc. After the success of the original piece, there is a target population, set theme and story, and more budget to produce the sequels. As a result, sequels are relatively low risk and easy for the film makers or publishers.
 
The tried and tested formula of making profit from sequels does not seem to be foolproof anymore.  Since 2015, the trend of failing sequels seems to increase. The audience is demanding more creativity and originality from Hollywood. In 2016, multiple sequels have failed such as The Divergent Series: Allegiant, Zoolander 2, The Huntsman: Winter’s War, War of the Planet of Ape, Pirates of the Caribbean: On Stranger Tides, Cars 3 and the list goes on! Even franchises like Pirates of the Caribbean is failing to cash in on the success of its prequels.  After seeing all the failures, we wondered if this implies that Hollywood would learn from its failures and invest in more original stories?

##What we expect to see

**Our prediction is both YES and NO!**

We share Steven Spielberg’s thought that a paradigm shift is inevitable in this industry. Given that there are a lot of other mainstream entertainment such as TV shows like Game of Thrones, Web Series, YouTube, Netflix, Hulu etc., people do not have to watch movies or they can prefer not to watch them in theaters. As a result, the revenue of Hollywood can drop! However, we need to remember that US is NOT the only target audience of Hollywood. The North America contributes to only 1/3 of the Hollywood’s income. The rest of world such as China, India, and many Asian and African countries are contributing to Hollywood’s revenue. The remakes and sequels might be boring and repetitive to the American audience, but the remakes or sequels are fresh and new to the 2/3 of Hollywood’s income generators. Therefore, Hollywood might not stop cashing in on the success of the originals right away! 

```{r, message=FALSE}
library(mdsr)
library(RMySQL)
library(tidyverse)
db <- dbConnect_scidb(dbname = "imdb")
```

```{r}
#All movies that are either sequels, remakes, spin offs or different versions of an original

rep <- "SELECT t.id, title, kind_id, production_year, linked_movie_id, mi.info as genre, mi2.info as country, link_type_id
FROM imdb.title t
#join to see how a movie is linked to another movie
JOIN movie_link ml
	ON t.id = ml.movie_id
#join to see info on movie like genre and country
JOIN movie_info mi
  ON t.id = mi.movie_id
#second join with title and movie_info to see genre and country
JOIN movie_info mi2
  ON t.id = mi2.movie_id
WHERE kind_id = 1 AND 
      #movies that are sequels, remakes, spin offs or a version of       the original
      ml.link_type_id IN (1,3,11,13) AND
      #see genres of all movies
      mi.info_type_id = 3 AND
      #filter for only U.S made movies
      mi2.info = 'USA'
GROUP BY t.id
ORDER BY production_year;
"

#save rep as a dataframe in R
repetitions <-db%>% 
  dbGetQuery(rep)
```
```{r}
link <- "SELECT *
from link_type
Where id IN (1,3,11,13);"

links <- db%>%
  dbGetQuery(link)
```

```{r}
#view the link_type of each movie
link_type <- repetitions %>%
  inner_join(links, by = c("link_type_id" = "id"))
```

```{r}
#omit null values
link_types <- na.omit(link_type)
```

```{r}
#Filter to see most popular genres
linktype1 <- link_types %>%
  group_by(production_year, link) %>%
  mutate(total_reps = count(link)) %>%
  filter(genre %in% c("Comedy", "Romance", "Action", "Thriller","Horror", "Animation", "Family"))
```

##Which genres are the most repetitive?

We have selected 6 genres, Action, Animation, Comedy, Family, Horror, Romance and Thriller to see which genres tended to have the most sequels, remakes, spin offs and different versions.

```{r}
#Which genre has the most sequels and remakes?
ggplot(linktype1, aes(x = production_year, y = total_reps, col = link))+
  geom_point(size = 0.6) +
  facet_wrap(~genre)
```

Our analysis shows that remakes and sequels seem to be most popular for movies with genres like Action, Animation, Comedy and to some extent Horror. However, Family, Romance and Thriller movies don't seem to have many follow up movies. 

The most popular types of follow-up movies 

##Have sequels become more frequent?

Now to test out predictions! Have sequels become more frequent? Do they come out in a shorter period of time? Let's find out!

```{r}
#Filter for only sequels (link_type_id = 1)

sequels <- repetitions%>%
  filter(link_type_id == 1)
```

```{r}
#Adding the production_year of prequel

sql2 <- "SELECT id, title, production_year as prequel_release_year
FROM title
WHERE kind_id = 1 
Group by id
;"

prequel_release <- db%>%
  dbGetQuery(sql2)
prequel_release
```

```{r}
#Join sequels tbl and prequel_release tbl

movies <- sequels %>%
  #join so that the sequels are linked to their prequels
  inner_join(prequel_release, by = c("linked_movie_id" = "id")) %>%
  #rename columns to make tbl easier to read
  rename(title = title.x, prequel_title = title.y) %>%
  #find the time between orginal and sequels for each movie
  mutate(time_between_sequels = production_year - prequel_release_year)

#omit NA values 
movies <- na.omit(movies)
glimpse(movies)

#Filter to see most popular genres
linktype1 <- link_types %>%
  group_by(production_year, link) %>%
  mutate(total_reps = count(link)) %>%
  filter(genre %in% c("Comedy", "Romance", "Action", "Thriller","Horror", "Animation", "Family"))
```
#Which genres are the most repetitive?

We have selected 6 genres --Action, Animation, Comedy, Family, Horror, Romance and Thriller-- to see which genres tend to have the most sequels, remakes, spin offs and different versions.
#Repition Amongst Genres
```{r}
#Which genre has the most sequels and remakes?
ggplot(linktype1, aes(x = production_year, y = total_reps, col = link))+
  geom_point(size = 0.6) +
  facet_wrap(~genre)
```
Our analysis shows that remakes and sequels seem to be most popular for movies with genres like Action, Animation, Comedy and to some extent Horror. However, Family, Romance and Thriller movies don't seem to have many follow up movies. 

##Have sequels become more frequent?

Now to test out predictions! Have sequels become more frequent? Do they come out in a shorter period of time? Let's find out!
```{r}
#Find movies (kind_id = 1) and are sequels (link_type_id = 1)

sql <- "SELECT t.id, title, kind_id, production_year, linked_movie_id, mi.info as genre, mi2.info as country
FROM imdb.title t
JOIN movie_link ml
	ON t.id = ml.movie_id
JOIN movie_info mi
  ON t.id = mi.movie_id
JOIN movie_info mi2
  ON t.id = mi2.movie_id
WHERE kind_id = 1 AND 
      #movies that are only sequels
      ml.link_type_id = 1 AND
      #see genres of all movies
      mi.info_type_id = 3 AND
      #filter for only U.S made movies
      mi2.info = 'USA'
GROUP BY t.id
ORDER BY production_year;
"

#save sql as a dataframe in R
sequels <-db%>% 
  dbGetQuery(sql)
```
```{r}
#Table of all movies with the production year

sql1.5 <- "SELECT id, title, production_year as prequel_release_year
FROM title
WHERE kind_id = 1 
Group by id
;"

prequel_release <- db%>%
  dbGetQuery(sql1.5)
```
```{r}
#Join sequels tbl and prequel_release tbl

movies <- sequels %>%
  #join so that the sequels are linked to their prequels
  inner_join(prequel_release, by = c("linked_movie_id" = "id")) %>%
  #rename columns to make tbl easier to read
  rename(title = title.x, prequel_title = title.y) %>%
  #look at movies after a certain time
  #filter(prequel_release_year >= 1950) %>%
  #find the time between orginal and sequels for each movie
  mutate(time_between_sequels = production_year - prequel_release_year)

#omit NA values 
movies <- na.omit(movies)
glimpse(movies)

#Find the average time between originals and their sequels by year
diff_prod <- movies %>%
  group_by(prequel_release_year)%>%
   filter(genre %in% c("Comedy", "Romance", "Action", "Thriller","Horror", "Animation", "Family")) %>%
  mutate(avg_difference = mean(time_between_sequels))
```
##How fast are sequels being produced?
```{r}
#create ggplot
ggplot(diff_prod, aes(x = prequel_release_year, y = avg_difference))+
  ggtitle("Sequels Over the Years")+
  geom_point(col = "lightcoral", size = 0.7)+
  #create a line to see a general trend
  geom_smooth(col = "gray34", size = 0.4, linetype = 1)
```

From the plot above we see that the average difference between release years of the orignal movie and its sequels have been changing over time. Prior to the 1940s, sequels came out quite frequently. However, movies produced between the 40s and 90s had sequels coming out much later than the original production year.

##Back-To-Back Sequels

##Which genre has the fastest growing sequel industry?
```{r, warning = FALSE}
ggplot(diff_prod, aes(x = prequel_release_year, y = time_between_sequels))+
  ggtitle("Sequels Over the Years")+
  geom_point(col = "lightcoral", size = 0.7)+
  #create a line to see a general trend
  geom_smooth(col = "gray34", size = 0.4, linetype = 1)+
  facet_wrap(~genre)
```

```{r}
avg_diff <- movies %>%
  group_by(genre, prequel_release_year)%>%
   filter(genre %in% c("Comedy", "Romance", "Action", "Thriller","Horror", "Animation", "Family")) %>%
  summarise(avg_difference = mean(time_between_sequels)) %>%
  filter(avg_difference >= 0)
avg_diff
```


```{r, warning = FALSE}
ggplot(final2, aes(x = prequel_release_year, y = avg_difference, fill = genre))+
  ggtitle("Sequels Over the Years")+
  #create a line to see a general trend
  geom_smooth(col = "gray34", size = 0.4, linetype = 1)
```

Above we see the average difference in production time between an original movie and its sequels.

What is interesting about the ggplot is we get to see the development of different genres over the years. Comedy seems to predate other genres, followed by Action and Animation. The newest genre seems to be Family, which also has the widest spread when it comes to the average spread between production year of original versus its sequel(s).

##Conclusion

##Limitations
