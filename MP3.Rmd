---
title: "MP3"
author: "Sneha Verma, Pema Choden, Tenzin Paldon"
date: "November 6, 2017"
output: html_document
---
##                 How Repetitive is Hollywood?

Is Hollywood more repetitive than it's ever been?

How often are remakes, sequels made? 

Lately, there has been a lot of criticism against remakes and sequels in Hollywood *(USA Today, 2016)*. One of most famous director of blockbusters, Steven Spielberg shared his concerns about this trend to Hollywood Reporter in June: “There’s going to be an implosion where three or four or maybe even a half-dozen megabudget movies are going to go crashing into the ground, and that’s going to change the paradigm.”

We want to study if the trend of sequels and remakes are a modern thing, or if it has existed since the beginning of film industry.

After some research on this topic, we realized that making sequels is no new phenomenon. The phenomenon of making sequels can be seen in one of the earliest forms of entertainment, oral storytelling. Homer’s Odyssey is in part a sequel to Iliad because of the widespread success of Iliad.  After oral poetry and storytelling, books are the oldest and most popular medium of entertainment. Some of the best sellers in late Victorian Era such as Robinson Crusoe (1719) and Gulliver’s Travels (1726) brought huge revenue to the publishers(Den of Geek). As a result of the huge economic gain, the publishers produced sequels like Memoirs of the Court of Lilliput (1727) and The New Gulliver (1730). This trend still exists in present day in TV Shows, books, and movies. We are all aware of the Fast and Furious Franchise, Hunger Games, Big Bang Theory, etc.

##Why make sequels?

 The first film, book, or show is the riskiest and most expensive. The makers have to invest a huge amount of money in advertising, building the story plot, costumes, etc. After the success of the original piece, there is a target population, set theme and story, and more budget to produce the sequels. As a result, sequels are relatively low risk and easy for the film makers or publishers.
 
The tried and tested formula of making profit from sequels does not seem to be foolproof anymore.  Since 2015, the trend of failing sequels seems to increase. The audience is demanding more creativity and originality from Hollywood. In 2016, multiple sequels have failed such as The Divergent Series: Allegiant, Zoolander 2, The Huntsman: Winter’s War, War of the Planet of Ape, Pirates of the Caribbean: On Stranger Tides, Cars 3 and the list goes on! Even franchises like Pirates of the Caribbean is failing to cash in on the success of its prequels.  After seeing all the failures, we wondered if this implies that Hollywood would learn from its failures and invest in more original stories?

##What we expect to see

**Our prediction is both YES and NO!**

We share Steven Spielberg’s thought that a paradigm shift is inevitable in this industry. Given that there are a lot of other mainstream entertainment such as TV shows like _Game of Thrones_, Web Series, YouTube, Netflix, Hulu etc., people do not have to watch movies or they can prefer not to watch them in theaters. As a result, the revenue of Hollywood can drop! However, we need to remember that US is NOT the only target audience of Hollywood. The North America contributes to only 1/3 of the Hollywood’s income. The rest of world such as China, India, and many Asian and African countries are contributing to Hollywood’s revenue. The remakes and sequels might be boring and repetitive to the American audience, but the remakes or sequels are fresh and new to the 2/3 of Hollywood’s income generators. Therefore, Hollywood might not stop cashing in on the success of the originals right away! 

```{r, message=FALSE}
library(mdsr)
library(RMySQL)
library(tidyverse)
db <- dbConnect_scidb(dbname = "imdb")
```

```{r}
#All movies that are either sequels, remakes, spin offs or different versions of an original

rep <- "SELECT t.id, title, kind_id, production_year, linked_movie_id, mi.info as genre, mi2.info as country, link_type_id
FROM imdb.title t
#join to see how a movie is linked to another movie
JOIN movie_link ml
	ON t.id = ml.movie_id
#join to see info on movie like genre and country
JOIN movie_info mi
  ON t.id = mi.movie_id
#second join with title and movie_info to see genre and country
JOIN movie_info mi2
  ON t.id = mi2.movie_id
WHERE kind_id = 1 AND 
      #movies that are sequels, remakes, spin offs or a version of       the original
      ml.link_type_id IN (1,3,11,13) AND
      #see genres of all movies
      mi.info_type_id = 3 AND
      #filter for only U.S made movies
      mi2.info = 'USA'
GROUP BY t.id
ORDER BY production_year;
"

#save rep as a dataframe in R
repetitions <-db%>% 
  dbGetQuery(rep)
```

```{r}
link <- "SELECT *
from link_type
Where id IN (1,3,11,13);"

links <- db%>%
  dbGetQuery(link)
```

```{r}
#view the link_type of each movie
link_type <- repetitions %>%
  inner_join(links, by = c("link_type_id" = "id"))

#omit null values
link_types <- na.omit(link_type)
```

```{r}
#Filter to see most popular genres
linktype1 <- link_types %>%
  group_by(production_year, link) %>%
  mutate(total_reps = count(link)) %>%
  filter(genre %in% c("Comedy", "Romance", "Action", "Thriller","Horror", "Animation", "Family"))
```

##Which genres are the most repetitive?

We have selected 6 genres, --Action, Animation, Comedy, Family, Horror, Romance and Thriller-- to see which genres tended to have the most sequels, remakes, spin offs and different versions.

```{r}
#Which genre has the most sequels and remakes?
ggplot(linktype1, aes(x = production_year, y = total_reps, col = link))+
  ggtitle("Follow Up Movies over time (by genre)")+
  scale_x_continuous("Year",
                     breaks = seq(0,2020,50))+
  scale_y_continuous("No. of Follow Up Movies")+
  scale_color_manual(values = c("#E6C42C","#2C9AE6","#1F8325","#E6612C"),
                     name = "Link Type",
                     breaks = c("follows", "remake of", "spin off from", "version of"),
                     labels = c("Sequel", "Remake", "Spin-Off", "Version"))+
  geom_point(size = 0.6, alpha = 0.3) +
  facet_wrap(~genre)+
  theme(title = element_text(face = "bold", size = 10),
        axis.title.x = element_text(size = 8),
        axis.title.y = element_text(size = 8),
        axis.text.x = element_text(size = 7),
        axis.text.y = element_text(size = 7))
```

Our analysis shows that remakes and sequels seem to be most popular for movies with genres like Action, Animation, Comedy and to some extent Horror. However, Family, Romance and Thriller movies don't seem to have many follow up movies. 

The most popular type of follow-up movies seem to be sequels, then versions of.

##Have sequels become more frequent?

Now to test out predictions! Have sequels become more frequent? Do they come out in a shorter period of time? Let's find out!

```{r}
#Filter for only sequels (link_type_id = 1)

sequels <- repetitions%>%
  filter(link_type_id == 1)
```

```{r}
#Adding the production_year of prequel

sql2 <- "SELECT id, title, production_year as prequel_release_year
FROM title
WHERE kind_id = 1 
Group by id
;"

prequel_release <- db%>%
  dbGetQuery(sql2)
```

```{r}
#Join sequels tbl and prequel_release tbl

movies <- sequels %>%
  #join so that the sequels are linked to their prequels
  inner_join(prequel_release, by = c("linked_movie_id" = "id")) %>%
  #rename columns to make tbl easier to read
  rename(title = title.x, prequel_title = title.y) %>%
  #find the time between orginal and sequels for each movie
  mutate(time_between_sequels = production_year - prequel_release_year)

#omit NA values 
movies <- na.omit(movies)
glimpse(movies)

#Find the average time between originals and their sequels by year
diff_prod <- movies %>%
  group_by(prequel_release_year)%>%
   filter(genre %in% c("Comedy", "Romance", "Action", "Thriller","Horror", "Animation", "Family")) %>%
  mutate(avg_difference = mean(time_between_sequels))
```

##How fast are sequels being produced?
```{r}
#create ggplot
ggplot(diff_prod, aes(x = prequel_release_year, y = avg_difference))+
  #add a title
  ggtitle("Difference in Production Years Between Sequels
                    and Original Movies")+
  geom_point(col = "#F6B54A", size = 0.7)+
  #create a line to see a general trend
  geom_smooth(col = "#0F75EA", size = 0.4, linetype = 1)+
  scale_x_continuous("Production Year (Original Film)",
                     breaks = seq(0,2020,20))+
  scale_y_continuous("Average Difference 
in Production Years")+
  theme(title = element_text(face = "bold", size = 10),
        axis.title.x = element_text(size = 8),
        axis.title.y = element_text(size = 8),
        axis.text.x = element_text(size = 7))
```

From the plot above we see that the average difference between release years of the orignal movie and its sequels have been changing over time. Prior to the 1940s, sequels came out quite frequently. However, movies produced between the 40s and 90s had sequels coming out much later than the original production year.

##Back-To-Back Sequels

In some instance we notice that sequels and the originals have the same production year. How could that be? 

Back-to-back sequels are shot to reduce costs and time taken to film. Examples of sequels filmed back-to-back are The Lord of the Rings trilogy, Kill Bill (one film split into two 'volumes') and Harry Potter and the Deathly Hallows (Part 1 and 2).

##Which genre has the fastest growing sequel industry?

```{r, warning = FALSE}
ggplot(diff_prod, aes(x = prequel_release_year, y = time_between_sequels))+
  ggtitle("Sequels by Genre")+
  scale_x_continuous("Production Year (Original Film)",
                     breaks = seq(0,2020,40))+
  scale_y_continuous("Original and Sequel 
  Production Year Difference",
                     breaks = seq(0,100, 40))+
  geom_point(col = "#5FBE67", size = 0.7, alpha = 0.3)+
  #create a line to see a general trend
  geom_smooth(col = "#3A7FD9", size = 0.4, linetype = 1)+
  facet_wrap(~genre)+
  theme(title = element_text(face = "bold", size = 10),
        axis.title.x = element_text(size = 8),
        axis.title.y = element_text(size = 8),
        axis.text.x = element_text(size = 7))
```

```{r}
avg_diff <- movies %>%
  group_by(genre, prequel_release_year)%>%
   filter(genre %in% c("Comedy", "Romance", "Action", "Thriller","Horror", "Animation", "Family")) %>%
  summarise(avg_difference = mean(time_between_sequels))
```


```{r, warning = FALSE}
ggplot(avg_diff, aes(x = prequel_release_year, y = avg_difference, fill = genre))+
  ggtitle("Sequels Over the Years (by genre)")+
  scale_x_continuous("Year",
                     breaks = seq(0,2020,40))+
  scale_y_continuous("Average Difference in Original
and Sequel Production Years",
                     breaks = seq(0,100, 40))+
  scale_fill_hue("Genre")+
  #create a line to see a general trend
  geom_smooth(col = "gray34", size = 0.4, linetype = 1)+
  theme(title = element_text(face = "bold", size = 10),
        axis.title.x = element_text(size = 8),
        axis.title.y = element_text(size = 8),
        axis.text.x = element_text(size = 7))
```

Above we see the average difference in production time between an original movie and its sequels.

What is interesting about the ggplot is we get to see the development of different genres over the years. Comedy seems to predate other genres, followed by Action and Animation. The newest genre seems to be Family, which also has the widest spread when it comes to the average spread between production year of original versus its sequel(s).

##Conclusion
Sequels, remakes, follow up films do not seem to be a new trend. Infact the idea of a series seems to predate the origins of film and take us back to oral story telling. 

Here are some general trends we see:

- Of the genres we looked at Action, Animation and Comedy had the highest number of sequels, while follow up movies were not so popular for Thriller, Romance and Family movies.

- The time between a sequel and the original film was very short before the 1940s. However this difference became wider between the 1960s and the 1980s. Since then there has been a general downward trend in the difference between the production year of an original movie and production year of its sequel.  

##Way Forward
- We could take a look at a wider range of genres like Sci-Fi, War, etc.

- Are sequels, remakes and reboots specific to Hollywood? How do sequels perform in other film indistries, eg. Bollywood?

- Do movies with sequels have a higher rank or make more money than movies without sequels?

## Sources
1. Bogage, Jacob. "Why film studios really like movie remakes" _Chicago Tribune_ 20 Nov., 2017: Web.
2. Lambie, Ryan. "The origins and evolution of the movie sequel" _Den of Geek_ 22 May, 2011: Web. 
3. Mandell, Andrea. "Grading the summer sequels:Which movies failed?" _USA Today_ 9 July, 2017: Web. 
4. McClintock, Pamela. "Sequels Moviegoers Don't Want" _The Hollywood Reporter_ 5 June, 2016: Web. 
5. Merry, Stephanie. "Moviegoers are sick of sequels. Here's why 'Blade Runner 2049' will go against the trend." _The  Washington Post_ 7 Oct, 2017: Web. 
6. Stephen, F. "The Scale of Hollywood remakes and reboots" _Stephen Follows_ 22 June, 2015: Web.
